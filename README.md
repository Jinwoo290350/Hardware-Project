# 👴 Elderly Fall Detection & Safety Alert System

ระบบตรวจจับการล้มและแจ้งเตือนฉุกเฉินสำหรับผู้สูงอายุ โดยใช้ ESP32 + Gyro Sensor + Blynk App

---

## 📋 ภาพรวมโปรเจกต์

ระบบนี้ออกแบบมาเพื่อช่วยดูแลความปลอดภัยของผู้สูงอายุ โดยใช้เซนเซอร์ตรวจจับการเคลื่อนไหว (Gyro Sensor) ติดตั้งบนตัวผู้สูงอายุ เมื่อตรวจพบท่าทางที่ผิดปกติหรือการล้ม ระบบจะแจ้งเตือนผู้ดูแล (ผู้ติดตาม) ผ่านแอปพลิเคชัน Blynk พร้อมส่งข้อมูลตำแหน่ง และแจ้งเตือนไปยังสายด่วน 1669

---

## 🧰 อุปกรณ์ที่ใช้

| อุปกรณ์ | จำนวน | หมายเหตุ |
|---------|--------|----------|
| ESP32 | 1 ตัว | ไมโครคอนโทรลเลอร์หลัก |
| Gyro Sensor (IMU) | 1 ตัว | ตรวจจับแกน X, Y, Z |

---

## 📱 แอปพลิเคชัน

ใช้แพลตฟอร์ม **Blynk** สำหรับการสื่อสารระหว่างอุปกรณ์และผู้ใช้

### ผู้ใช้งานในระบบ

- ⭐ **Board 1 — ผู้ติดตาม (ผู้ดูแล)** : รับการแจ้งเตือนและติดตามตำแหน่ง
- 🌟 **Board 2 — ผู้สูงอายุ** : สวมใส่อุปกรณ์ตรวจจับ

---

## 🖥️ UX/UI ของแอป

หน้าจอแอปพลิเคชันแบ่งเป็น 3 ส่วนหลัก:

1. **แผนที่ติดตามตำแหน่ง** — แสดงตำแหน่งปัจจุบันของผู้สูงอายุบนแผนที่แบบ Real-time
2. **แผนที่เส้นทาง** — แสดงเส้นทางการเคลื่อนที่พร้อมจุดที่เกิดเหตุ
3. **ข้อมูลผู้สูงอายุ** — แสดงข้อมูลส่วนตัว เช่น ชื่อ, นามสกุล, โรคประจำตัว, แพ้ยา, ประวัติการรักษา

### ปุ่มควบคุมในแอป

- `ส่งสัญญาณ` / `ยกเลิก` — ส่งหรือยกเลิกสัญญาณแจ้งเตือน
- `ข้อมูลเพิ่มเติม` — ดูข้อมูลผู้สูงอายุ
- `แจ้ง 1669` — ส่งข้อมูลไปยังหน่วยกู้ชีพ

---

## 🔄 Flowchart การทำงาน

```
เปิดใช้งาน
    │
    ▼
รับสัญญาณจากแอป ──────────────────────────── กดปุ่ม ESP32 ของผู้สูงอายุ
    │                                                    │
    ▼                                                    ▼
ถูกต้อง?  ──ไม่──► [วนซ้ำ]             รับสัญญาณจากปุ่ม
    │                                                    │
   ใช่                                                   ▼
    │                                               ถูกต้อง? ──ไม่──► [วนซ้ำ]
    ▼                                                    │
แกน X, Y, Z ◄────── Gyro Sensor                        ใช่
รับค่าเซนเซอร์                                          │
    │                                                    │
    ▼                                                    ▼
คำนวณ X, Y, Z                                    [รวมผลที่ Node]
    │                                                    │
    ▼                                                    ▼
อยู่ในระนาบ                              ┌──────────────┴──────────────┐
ที่ควรเป็น? ──ใช่──►                    ▼                             ▼
    │                              ระบุตำแหน่ง              ได้รับการ
   ไม่                               (Location)             ช่วยเหลือ?
    │                                    │                       │
    ▼                                    ▼                      ใช่
[แจ้งเตือน]                         แจ้ง 1669              [จบการทำงาน]
                                         │                       │
                                         ▼                      ไม่
                                       ร้อง (Alert)              │
                                                            [วนซ้ำ]
```

---

## ⚙️ เหตุผลการทำงานของระบบช่วยเหลือ

| ฟีเจอร์ | คำอธิบาย |
|--------|----------|
| **Gyro → ESP32** | Gyro Sensor ส่งข้อมูลค่าแกนไปยัง ESP32 แล้วเข้าข่ายรายการผู้สูงอายุลัมอยู่ |
| **กดปุ่มจาก ESP32** | ผู้สูงอายุ หรือ ผู้ดูแล สามารถกดปุ่มบนอุปกรณ์เพื่อส่งสัญญาณฉุกเฉิน |
| **กดปุ่มจากแอป** | ผู้สูงอายุ หรือ ผู้ดูแล สามารถกดปุ่มบนแอป Blynk เพื่อส่งสัญญาณฉุกเฉิน |

---

## 🔗 การเชื่อมต่อระบบ

```
[Gyro Sensor] ──► [ESP32] ──► [Blynk Cloud] ──► [แอปผู้ดูแล]
                                    │
                                    ▼
                              [แจ้ง 1669 / SMS]
```

---

## 📦 การติดตั้ง

### 1. ติดตั้ง Library ที่จำเป็น (Arduino IDE)

```cpp
#include <WiFi.h>
#include <BlynkSimpleEsp32.h>
#include <Wire.h>
#include <MPU6050.h>   // หรือ IMU Library ที่ใช้
```

### 2. ตั้งค่า Blynk Token

```cpp
#define BLYNK_TEMPLATE_ID   "YourTemplateID"
#define BLYNK_TEMPLATE_NAME "ElderlyTracker"
#define BLYNK_AUTH_TOKEN    "YourAuthToken"
```

### 3. ตั้งค่า WiFi

```cpp
char ssid[] = "YourWiFiSSID";
char pass[] = "YourWiFiPassword";
```

### 4. ตั้งค่า Threshold การล้ม

```cpp
// ปรับค่าตาม Gyro Sensor ที่ใช้งาน
#define FALL_THRESHOLD_X  2.5
#define FALL_THRESHOLD_Y  2.5
#define FALL_THRESHOLD_Z  2.5
```

---

## 🗂️ โครงสร้างโปรเจกต์

```
elderly-safety-system/
├── firmware/
│   ├── main.ino              # โค้ดหลัก ESP32
│   ├── gyro_handler.cpp      # จัดการ Gyro Sensor
│   └── blynk_handler.cpp     # จัดการการสื่อสาร Blynk
├── app/
│   └── blynk_dashboard.json  # ตั้งค่า Blynk Dashboard
├── docs/
│   ├── flowchart.png         # แผนภาพการทำงาน
│   └── ui_mockup.png         # ตัวอย่าง UI/UX
└── README.md
```

---

## 📡 Blynk Virtual Pins

| Virtual Pin | ฟังก์ชัน |
|-------------|----------|
| V0 | ข้อมูลแกน X จาก Gyro |
| V1 | ข้อมูลแกน Y จาก Gyro |
| V2 | ข้อมูลแกน Z จาก Gyro |
| V3 | สถานะการแจ้งเตือน |
| V4 | ตำแหน่ง GPS (Latitude) |
| V5 | ตำแหน่ง GPS (Longitude) |
| V6 | ปุ่มฉุกเฉินจากแอป |

---

## 🚨 การแจ้งเตือน

ระบบจะแจ้งเตือนเมื่อ:
- ค่า Gyro Sensor เกิน Threshold ที่กำหนด (ตรวจพบการล้ม)
- ผู้สูงอายุกดปุ่มฉุกเฉินบน ESP32
- ผู้สูงอายุหรือผู้ดูแลกดปุ่มฉุกเฉินบนแอป Blynk

การแจ้งเตือนประกอบด้วย:
- แจ้งเตือนไปยังผู้ดูแลผ่าน Blynk Notification
- ส่งตำแหน่งที่เกิดเหตุ
- แจ้งสายด่วน **1669** (หน่วยกู้ชีพ)

---

## 🤝 ผู้พัฒนา

> โปรเจกต์นี้พัฒนาเพื่อช่วยดูแลความปลอดภัยของผู้สูงอายุ โดยบูรณาการ IoT Hardware กับ Mobile Application

---

## 📄 License

MIT License — Free to use and modify
